<Window x:Class="GenericLauncher.Views.AppDetectionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Auto-Detect Applications" Height="700" Width="850"
        Background="#172330"
        WindowStartupLocation="CenterOwner">
    <Window.Resources>
        <ResourceDictionary Source="/Styles/AppStyles.xaml"/>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0"
                   Text="Auto-Detect Applications"
                   FontSize="24"
                   FontWeight="Bold"
                   Foreground="White"
                   Margin="0,0,0,10"/>

        <!-- Instructions -->
        <TextBlock Grid.Row="1"
                   TextWrapping="Wrap"
                   Foreground="#CCCCCC"
                   Margin="0,0,0,15">
            <Run Text="Select the applications you want to add to your library."/>
            <LineBreak/>
            <Run Text="Applications already in your library are not shown."/>
        </TextBlock>

        <!-- List of detected apps -->
        <Border Grid.Row="2"
                Background="{StaticResource CardBrush}"
                BorderBrush="{StaticResource DarkCardBrush}"
                BorderThickness="1"
                CornerRadius="6"
                Margin="0,0,0,15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Select All / None -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10,10,10,5">
                    <Button Content="Select All"
                            Click="SelectAll_Click"
                            Style="{StaticResource SecondaryButton}"
                            Padding="10,5"
                            Margin="0,0,5,0"/>
                    <Button Content="Select None"
                            Click="SelectNone_Click"
                            Style="{StaticResource SecondaryButton}"
                            Padding="10,5"/>
                </StackPanel>

                <!-- Scrollable list -->
                <ScrollViewer Grid.Row="1"
                              VerticalScrollBarVisibility="Auto"
                              Margin="5">
                    <ItemsControl x:Name="AppsListBox" ItemsSource="{Binding}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#1E2C3A"
                                        Margin="5"
                                        Padding="10"
                                        CornerRadius="4">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Checkbox -->
                                        <CheckBox Grid.Column="0"
                                                  IsChecked="{Binding IsSelected}"
                                                  VerticalAlignment="Center"
                                                  Margin="0,0,10,0"/>

                                        <!-- App Info -->
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="{Binding Name}"
                                                       FontWeight="SemiBold"
                                                       FontSize="14"
                                                       Foreground="White"/>
                                            <TextBlock Text="{Binding Path}"
                                                       FontSize="11"
                                                       Foreground="#888888"
                                                       TextTrimming="CharacterEllipsis"/>
                                        </StackPanel>

                                        <!-- Category badge -->
                                        <Border Grid.Column="2"
                                                Background="{StaticResource PrimaryBrush}"
                                                CornerRadius="3"
                                                Padding="8,3"
                                                VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Category}"
                                                       FontSize="11"
                                                       Foreground="White"/>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Bottom buttons -->
        <StackPanel Grid.Row="3"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right">
            <TextBlock x:Name="CountTextBlock"
                       VerticalAlignment="Center"
                       Foreground="White"
                       Margin="0,0,15,0"
                       FontSize="14"/>
            <Button Content="Import Selected"
                    Click="Import_Click"
                    Style="{StaticResource SuccessButton}"
                    Width="150"
                    Margin="0,0,10,0"/>
            <Button Content="Cancel"
                    Click="Cancel_Click"
                    Style="{StaticResource SecondaryButton}"
                    Width="100"/>
        </StackPanel>
    </Grid>
</Window>
